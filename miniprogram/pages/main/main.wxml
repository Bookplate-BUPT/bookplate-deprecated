<!--pages/main/main.wxml-->

<van-sticky>
  <view style="margin-top: -8px">
    <van-search value="{{ searchWord }}" bind:search="keySearch" shape="round" use-action-slot="true" background="#8ac286">
      <view slot="action" bindtap="scanSearch" style="margin-top: 4px;">
        <van-icon name="scan" size="20px" />
      </view>
    </van-search>
  </view>
</van-sticky>

<van-tabs active="{{ active }}" style="margin-top: -8px" sticky animated offset-top="{{ 50 }}" swipeable color="#659c64">
  <!-- 卖书部分 -->
  <van-tab title="卖书">
    <!-- 卖书部分书籍分类菜单栏 -->
    <van-dropdown-menu active-color="#8ac286">
      <van-dropdown-item value="{{ bookType }}" options="{{ bookTypeOption }}" bind:change="bookTypeChange" />
      <van-dropdown-item value="{{ sortType }}" options="{{ sortTypeOption }}" bind:change="sortTypeChange" />
    </van-dropdown-menu>

    <!-- 卖书书籍陈列 -->
    <view wx:for="{{ goodsList }}" style="margin-top: 12px;" wx:key="_id">
      <van-cell-group inset custom-class="shadow">
        <van-swipe-cell right-width="{{ 100 }}" left-width="{{ 60 }}">
          <van-button slot="left" color="#FFC125" custom-class="swiperCellButton" bind:click="favoriteGoods">
            <van-icon name="star" />
            <view>收藏</view>
          </van-button>

          <van-card price="{{ item.price }}" desc="{{ item.description }}" thumb="{{ item.image_list[0] }}" origin-price="{{ item.original_price }}" data-id="{{ item._id }}" bindtap="goToBookDetail" tag="{{ item.isNew ? '最新' : '' }}">
            <view slot="title" style="font-weight: bold;">
              {{ item.name }}
              <van-tag color="{{ item.grade === '本科生' ? '#a0d911' : '#13c2c2' }}" plain custom-class="tagMargin">{{ item.grade }}</van-tag>
            </view>
          </van-card>

          <van-button slot="right" block color="#8ac286" custom-class="swiperCellButton" bind:click="addGoodsToCart" data-id="{{ item._id }}">
            <van-icon name="shopping-cart" />
            <view>加入购物车</view>
          </van-button>
        </van-swipe-cell>
      </van-cell-group>
    </view>

    <!-- 底部提示分隔线 -->
    <van-divider contentPosition="center" dashed style="margin-top: 16px;">没有更多啦</van-divider>
  </van-tab>

  <!-- 求书部分 -->
  <van-tab title="求书">内容 2</van-tab>
</van-tabs>